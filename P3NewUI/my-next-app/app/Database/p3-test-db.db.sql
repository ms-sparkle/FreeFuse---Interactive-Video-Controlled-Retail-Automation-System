BEGIN TRANSACTION;
CREATE TABLE IF NOT EXISTS "ACCOUNT" (
	"AccountID"	INTEGER,
	"Username"	TEXT NOT NULL UNIQUE,
	"PasswordHash"	TEXT NOT NULL,
	PRIMARY KEY("AccountID" AUTOINCREMENT)
);
CREATE TABLE IF NOT EXISTS "ATHLETE" (
	"PersonID"	INTEGER,
	"HoursSpentWorkingOut"	REAL,
	"SportPlayed"	TEXT,
	"Team"	TEXT,
	PRIMARY KEY("PersonID"),
	FOREIGN KEY("PersonID") REFERENCES "PERSON"("PersonID") ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS "ATHLETE_COACH" (
	"AthletePersonID"	INTEGER,
	"CoachPersonID"	INTEGER,
	"StartDate"	DATE,
	"EndDate"	DATE,
	PRIMARY KEY("AthletePersonID","CoachPersonID","StartDate"),
	FOREIGN KEY("AthletePersonID") REFERENCES "ATHLETE"("PersonID"),
	FOREIGN KEY("CoachPersonID") REFERENCES "COACH"("PersonID")
);
CREATE TABLE IF NOT EXISTS "ATHLETE_SCORE_HISTORY" (
	"ScoreID"	INTEGER,
	"AthletePersonID"	INTEGER NOT NULL,
	"ScoreDate"	DATE NOT NULL,
	"InjuryRiskScore"	REAL,
	"ProgressScore"	REAL,
	"ModelVersion"	TEXT,
	"Notes"	TEXT,
	PRIMARY KEY("ScoreID" AUTOINCREMENT),
	FOREIGN KEY("AthletePersonID") REFERENCES "ATHLETE"("PersonID")
);
CREATE TABLE IF NOT EXISTS "BODYPART" (
	"BodyPartID"	INTEGER,
	"Name"	TEXT NOT NULL,
	"Side"	TEXT,
	PRIMARY KEY("BodyPartID" AUTOINCREMENT),
	UNIQUE("Name","Side")
);
CREATE TABLE IF NOT EXISTS "COACH" (
	"PersonID"	INTEGER,
	PRIMARY KEY("PersonID"),
	FOREIGN KEY("PersonID") REFERENCES "PERSON"("PersonID") ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS "COACH_OBSERVATION" (
	"ObservationID"	INTEGER,
	"ObservationDate"	DATE NOT NULL,
	"Notes"	TEXT,
	"CoachPersonID"	INTEGER NOT NULL,
	"AthletePersonID"	INTEGER NOT NULL,
	PRIMARY KEY("ObservationID" AUTOINCREMENT),
	FOREIGN KEY("AthletePersonID") REFERENCES "ATHLETE"("PersonID"),
	FOREIGN KEY("CoachPersonID") REFERENCES "COACH"("PersonID")
);
CREATE TABLE IF NOT EXISTS "PERSON" (
	"PersonID"	INTEGER,
	"FirstName"	TEXT NOT NULL,
	"LastName"	TEXT NOT NULL,
	"DateOfBirth"	DATE,
	"AccountID"	INTEGER UNIQUE,
	PRIMARY KEY("PersonID" AUTOINCREMENT),
	FOREIGN KEY("AccountID") REFERENCES "ACCOUNT"("AccountID") ON DELETE SET NULL
);
CREATE TABLE IF NOT EXISTS "PLAN_WORKOUT" (
	"PlanID"	INTEGER,
	"WorkoutID"	INTEGER,
	"OrderIndex"	INTEGER,
	"Sets"	INTEGER,
	"Reps"	INTEGER,
	"DurationMinutes"	INTEGER,
	"Notes"	TEXT,
	PRIMARY KEY("PlanID","WorkoutID"),
	FOREIGN KEY("PlanID") REFERENCES "TRAINING_PLAN"("PlanID"),
	FOREIGN KEY("WorkoutID") REFERENCES "WORKOUT"("WorkoutID")
);
CREATE TABLE IF NOT EXISTS "SORENESS_ENTRY" (
	"EntryID"	INTEGER,
	"ReportID"	INTEGER NOT NULL,
	"BodyPartID"	INTEGER NOT NULL,
	"SorenessLevel"	INTEGER CHECK("SorenessLevel" BETWEEN 0 AND 10),
	PRIMARY KEY("EntryID" AUTOINCREMENT),
	UNIQUE("ReportID","BodyPartID"),
	FOREIGN KEY("BodyPartID") REFERENCES "BODYPART"("BodyPartID"),
	FOREIGN KEY("ReportID") REFERENCES "SORENESS_REPORT"("ReportID")
);
CREATE TABLE IF NOT EXISTS "SORENESS_REPORT" (
	"ReportID"	INTEGER,
	"ReportDate"	DATE NOT NULL,
	"AthletePersonID"	INTEGER NOT NULL,
	PRIMARY KEY("ReportID" AUTOINCREMENT),
	FOREIGN KEY("AthletePersonID") REFERENCES "ATHLETE"("PersonID")
);
CREATE TABLE IF NOT EXISTS "TRAINING_PLAN" (
	"PlanID"	INTEGER,
	"PlanName"	TEXT NOT NULL,
	"CoachPersonID"	INTEGER,
	"AthletePersonID"	INTEGER,
	PRIMARY KEY("PlanID" AUTOINCREMENT),
	FOREIGN KEY("AthletePersonID") REFERENCES "ATHLETE"("PersonID"),
	FOREIGN KEY("CoachPersonID") REFERENCES "COACH"("PersonID")
);
CREATE TABLE IF NOT EXISTS "WORKOUT" (
	"WorkoutID"	INTEGER,
	"WorkoutName"	TEXT NOT NULL,
	"BodyPartID"	INTEGER,
	PRIMARY KEY("WorkoutID" AUTOINCREMENT),
	FOREIGN KEY("BodyPartID") REFERENCES "BODYPART"("BodyPartID")
);
CREATE TABLE IF NOT EXISTS "WORKOUT_SESSION" (
	"SessionID"	INTEGER,
	"SessionDate"	DATE NOT NULL,
	"AthletePersonID"	INTEGER NOT NULL,
	"WorkoutID"	INTEGER NOT NULL,
	"Notes"	TEXT,
	PRIMARY KEY("SessionID" AUTOINCREMENT),
	FOREIGN KEY("AthletePersonID") REFERENCES "ATHLETE"("PersonID"),
	FOREIGN KEY("WorkoutID") REFERENCES "WORKOUT"("WorkoutID")
);
INSERT INTO "ACCOUNT" VALUES (1,'jdoe_athlete','hash_secure_123');
INSERT INTO "ACCOUNT" VALUES (2,'msmith_coach','hash_secure_456');
INSERT INTO "ACCOUNT" VALUES (3,'bsmith_athlete','hash_secure_789');
INSERT INTO "ATHLETE" VALUES (1,12.5,'Basketball','Varsity Tigers');
INSERT INTO "ATHLETE" VALUES (3,8.0,'Soccer','City United');
INSERT INTO "ATHLETE_COACH" VALUES (1,2,'2025-01-01',NULL);
INSERT INTO "ATHLETE_COACH" VALUES (3,2,'2025-02-01',NULL);
INSERT INTO "ATHLETE_SCORE_HISTORY" VALUES (1,1,'2026-02-28',0.85,0.65,'v2.1','Risk elevated due to reported knee soreness.');
INSERT INTO "BODYPART" VALUES (1,'Knee','Left');
INSERT INTO "BODYPART" VALUES (2,'Knee','Right');
INSERT INTO "BODYPART" VALUES (3,'Shoulder','Left');
INSERT INTO "BODYPART" VALUES (4,'Hamstring','Both');
INSERT INTO "COACH" VALUES (2);
INSERT INTO "COACH_OBSERVATION" VALUES (1,'2026-02-28','John is leaning too far forward on jumps. Needs to engage glutes.',2,1);
INSERT INTO "PERSON" VALUES (1,'John','Doe','2002-05-15',1);
INSERT INTO "PERSON" VALUES (2,'Mary','Smith','1985-11-20',2);
INSERT INTO "PERSON" VALUES (3,'Bill','Smith','2001-02-10',3);
INSERT INTO "PLAN_WORKOUT" VALUES (1,1,1,4,10,15,'Explosive movement focus');
INSERT INTO "PLAN_WORKOUT" VALUES (1,2,2,3,12,10,'Light weight for stability');
INSERT INTO "PLAN_WORKOUT" VALUES (2,3,1,5,5,20,'Focus on form over weight');
INSERT INTO "SORENESS_ENTRY" VALUES (1,1,1,7);
INSERT INTO "SORENESS_REPORT" VALUES (1,'2026-02-28',1);
INSERT INTO "TRAINING_PLAN" VALUES (1,'Power Vertical Jump',2,1);
INSERT INTO "TRAINING_PLAN" VALUES (2,'Endurance Foundation',2,3);
INSERT INTO "WORKOUT" VALUES (1,'Squat Jumps',1);
INSERT INTO "WORKOUT" VALUES (2,'Shoulder Press',3);
INSERT INTO "WORKOUT" VALUES (3,'Deadlift',4);
INSERT INTO "WORKOUT_SESSION" VALUES (1,'2026-02-28',1,1,'Felt a bit of a twinge in the left knee during the 3rd set.');
COMMIT;
